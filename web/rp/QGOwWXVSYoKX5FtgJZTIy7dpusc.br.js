var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},SydneyFullScreenConv;(function(n){function kr(u){var f,a,p,w,d,g,rt,ut,ft,et,at,vt,pt,dt,ii,ri,oi,ci,li,ai,di,br,kr,dr,tu,ru,uu,fu,eu,ou,cu,lu,au,vu,yu,du,gu,tf,rf,uf,ff,ef,sf,hf,cf,lf,af,df,gf,te,ie,ue,fe,ee,oe,se,he,ce,le,ae,ve,ye,pe,we,be,ke,de,ge,no,to,io,ro,uo,fo;return u===void 0&&(u=null),__awaiter(this,void 0,void 0,function(){var is,rs,us,vs,ys,ao,co,fs,vo,es,yo,lo,po,wo,bo,ps,os,ss,hs,cs,ko,ls,go,eo,so,oo,ns,ts,ho,as;return __generator(this,function(ws){switch(ws.label){case 0:return(i=_ge(su),i.querySelector("cib-serp"))?[2]:(ui=(f=_w._sydConvConfig)===null||f===void 0?void 0:f.usePill,ot=(a=_w._sydConvConfig)===null||a===void 0?void 0:a.enableScrollOut,fi=(p=_w._sydConvConfig)===null||p===void 0?void 0:p.enableSydContext,h=(w=_w._sydConvConfig)===null||w===void 0?void 0:w.convBackBtn,st=(d=_w._sydConvConfig)===null||d===void 0?void 0:d.enableSetConvQueryFlag,pu=(g=_w._sydConvConfig)===null||g===void 0?void 0:g.enableSydTigerAns,vi=(rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSydAjax,yt=(ut=_w._sydConvConfig)===null||ut===void 0?void 0:ut.enableSydCarousel,n.moveOnlySydXAnswers=(ft=_w._sydConvConfig)===null||ft===void 0?void 0:ft.moveOnlySydXAnswers,c=(et=_w._sydConvConfig)===null||et===void 0?void 0:et.hideSydFSC,l=(at=_w._sydConvConfig)===null||at===void 0?void 0:at.enableSydOverlay,ei=(vt=_w._sydConvConfig)===null||vt===void 0?void 0:vt.enable1TCibSlot,nt=(pt=_w._sydConvConfig)===null||pt===void 0?void 0:pt.enableSydX1T,pi=(dt=_w._sydConvConfig)===null||dt===void 0?void 0:dt.hideSydMic,wi=(ii=_w._sydConvConfig)===null||ii===void 0?void 0:ii.fromNoResults,ir=(ri=_w._sydConvConfig)===null||ri===void 0?void 0:ri.codexWinEnableCustomGreeting,rr=(oi=_w._sydConvConfig)===null||oi===void 0?void 0:oi.codexWinGreetingCustomString,gi=(ci=_w._sydConvConfig)===null||ci===void 0?void 0:ci.checkCreatorAnsFor1T,bi=SydFSCHelper.getConfigOrDefault((li=_w._sydConvConfig)===null||li===void 0?void 0:li.enableSydCarouselHistory,!1),wu=SydFSCHelper.getConfigOrDefault((ai=_w._sydConvConfig)===null||ai===void 0?void 0:ai.enableSQMsg,!1),ki=SydFSCHelper.getConfigOrDefault((di=_w._sydConvConfig)===null||di===void 0?void 0:di.enableSemSerpNoCache,!1),nr=SydFSCHelper.getConfigOrDefault((br=_w._sydConvConfig)===null||br===void 0?void 0:br.enableSydStaticAdsLink,!1),is=SydFSCHelper.getConfigOrDefault((kr=_w._sydConvConfig)===null||kr===void 0?void 0:kr.hideSydReconnect,!1),rs=(dr=_w._sydConvConfig)===null||dr===void 0?void 0:dr.enableDlBing,us=(tu=_w._sydConvConfig)===null||tu===void 0?void 0:tu.disableSydGhosting,vs=SydFSCHelper.getConfigOrDefault((ru=_w._sydConvConfig)===null||ru===void 0?void 0:ru.disableCibNotificationStyleUpdate,!1),ys=_w._sydCachedString,ao=_w._sydAddOptionsSet,_G[SydFSCHelper.SYD_MODE]="serp",_G[SydFSCHelper.SYD_PREV_MODE]="",yi=SydFSCHelper.getConfigOrDefault((uu=_w._sydConvConfig)===null||uu===void 0?void 0:uu.keyboardNavigationSydney,!1),wt=SydFSCHelper.getConfigOrDefault((fu=_w._sydConvConfig)===null||fu===void 0?void 0:fu.disableTabletScroll,!1),bt=SydFSCHelper.getConfigOrDefault((eu=_w._sydConvConfig)===null||eu===void 0?void 0:eu.disableTouchDesktopScroll,!1),kt=SydFSCHelper.getConfigOrDefault((ou=_w._sydConvConfig)===null||ou===void 0?void 0:ou.disableDesktopScroll,!1),tr=SydFSCHelper.getConfigOrDefault((cu=_w._sydConvConfig)===null||cu===void 0?void 0:cu.enableChatScrollFix,!1),gt=SydFSCHelper.getConfigOrDefault((lu=_w._sydConvConfig)===null||lu===void 0?void 0:lu.enableConvModeSwitchAjax,!1),ur=SydFSCHelper.getConfigOrDefault((au=_w._sydConvConfig)===null||au===void 0?void 0:au.enableCssSplitConvModeOnClick,0),it=SydFSCHelper.getConfigOrDefault((vu=_w._sydConvConfig)===null||vu===void 0?void 0:vu.chatBackgroundColorOverride,""),vr=SydFSCHelper.getConfigOrDefault((yu=_w._sydConvConfig)===null||yu===void 0?void 0:yu.chatBackgroundColorOverrideNoSerp,!1),lt=SydFSCHelper.getConfigOrDefault((du=_w._sydConvConfig)===null||du===void 0?void 0:du.enableWelcomeScreenV2,!1),ct=SydFSCHelper.getConfigOrDefault((gu=_w._sydConvConfig)===null||gu===void 0?void 0:gu.enableWelcomeScreenV3,!1),si=SydFSCHelper.getConfigOrDefault((tf=_w._sydConvConfig)===null||tf===void 0?void 0:tf.enableGptHomeScreen,!1),hi=SydFSCHelper.getConfigOrDefault((rf=_w._sydConvConfig)===null||rf===void 0?void 0:rf.enableChatFRE,!1),fr=SydFSCHelper.getConfigOrDefault((uf=_w._sydConvConfig)===null||uf===void 0?void 0:uf.enable2TQueryConfigsOnSerpLoad,!1),er=SydFSCHelper.getConfigOrDefault((ff=_w._sydConvConfig)===null||ff===void 0?void 0:ff.enableBackgroundFix,!1),or=SydFSCHelper.getConfigOrDefault((ef=_w._sydConvConfig)===null||ef===void 0?void 0:ef.hideMuidUpsell,!1),sr=SydFSCHelper.getConfigOrDefault((sf=_w._sydConvConfig)===null||sf===void 0?void 0:sf.enableSERPHideShowConv,!1),hr=SydFSCHelper.getConfigOrDefault((hf=_w._sydConvConfig)===null||hf===void 0?void 0:hf.enableBceBcbToggle,!1),s=SydFSCHelper.getConfigOrDefault((cf=_w._sydConvConfig)===null||cf===void 0?void 0:cf.enableNotebookMode,!1),cr=SydFSCHelper.getConfigOrDefault((lf=_w._sydConvConfig)===null||lf===void 0?void 0:lf.enableNotebookScrollDown,!1),lr=SydFSCHelper.getConfigOrDefault((af=_w._sydConvConfig)===null||af===void 0?void 0:af.enableSydTestCache,!1),tt=SydFSCHelper.getConfigOrDefault((df=_w._sydConvConfig)===null||df===void 0?void 0:df.enableChatContAfterHeader,!1),ar=SydFSCHelper.getConfigOrDefault((gf=_w._sydConvConfig)===null||gf===void 0?void 0:gf.enableSafeChatAnsStyle,!1),co=SydFSCHelper.getConfigOrDefault((te=_w._sydConvConfig)===null||te===void 0?void 0:te.isCopilotChat,!1),fs=SydFSCHelper.getConfigOrDefault((ie=_w._sydConvConfig)===null||ie===void 0?void 0:ie.enableCopilotChatIdentityDisplay,!1),e=SydFSCHelper.getConfigOrDefault((ue=_w._sydConvConfig)===null||ue===void 0?void 0:ue.isNewBingChat,!1),yr=SydFSCHelper.getConfigOrDefault((fe=_w._sydConvConfig)===null||fe===void 0?void 0:fe.isMobileHost,!1)&&(co||e),pr=SydFSCHelper.getConfigOrDefault((ee=_w._sydConvConfig)===null||ee===void 0?void 0:ee.enableFakeScrollTelemetry,!1),bu=SydFSCHelper.getConfigOrDefault((oe=_w._sydConvConfig)===null||oe===void 0?void 0:oe.enableSearchQueryTelemetryFix,!1),ni=SydFSCHelper.getConfigOrDefault((se=_w._sydConvConfig)===null||se===void 0?void 0:se.enableBingChatPath,!1),wr=SydFSCHelper.getConfigOrDefault((he=_w._sydConvConfig)===null||he===void 0?void 0:he.redirectAllChatEntryPointsToNCP,!1),ku=SydFSCHelper.getConfigOrDefault((ce=_w._sydConvConfig)===null||ce===void 0?void 0:ce.enableFixScrollBackSerpAccidentally,!1),vo=SydFSCHelper.getConfigOrDefault((le=_w._sydConvConfig)===null||le===void 0?void 0:le.isGptCreator,!1),es=SydFSCHelper.getConfigOrDefault((ae=_w._sydConvConfig)===null||ae===void 0?void 0:ae.disableGptCreatorFileUploadOptionsSets,!1),b=_d.createElement("slot"),b.setAttribute("name","firstAnswer"),b.setAttribute("slot","firstAns"),k=_d.createElement("slot"),k.setAttribute("name","firstAns"),o=((ve=_d.getElementsByClassName("b_top"))===null||ve===void 0?void 0:ve.length)>0?_d.getElementsByClassName("b_top")[0]:null,ht=!o?!1:o.getElementsByClassName("b_wpt_ch").length>0||o.getElementsByClassName("qna-sydney").length>0,tt?i&&Lib.CssClass.add(sj_b,hu):(yo=_ge("b_header"),i&&yo&&sj_b.insertBefore(i,yo)),r=_d.createElement("div"),r===null||r===void 0?void 0:r.setAttribute("slot","firstAnswer"),r===null||r===void 0?void 0:r.setAttribute("id","sydFirstAnswer"),r.style.maxWidth="648px",!!(co||e||vo))?[3,2]:[4,SydFSCHelper.setConvTranslationAsync()];case 1:ws.sent();ws.label=2;case 2:if(SydFSCHelper.setConfigs(u),SydFSCHelper.setEventListeners(),SydFSCHelper.setSydFSCEligibleState(!0),lo=SydFSCHelper.getConfigOrDefault((ye=_w._sydConvConfig)===null||ye===void 0?void 0:ye.isCompliantSydneyEndpointEnabled,!1),lo&&(MsbSydneyHelper.setCompliantSydneyUrls(),CIB.responseTone=undefined),vo?(CIB.setGptCreatorMode(),ti(i),CIB.config.sydney.request.optionsSets=["nlu_direct_response_filter","deepleo","enable_debug_commands","disable_emoji_spoken_text","responsible_ai_policy_235","enablemm","dv3sugg","autosave","iyxapbing","iycapbing","pluginval","eredirecturl","flux_phone_beta","clgalileo","gencontentv3","flux_botbuilder_base",],CIB.manager.chat.api.bing._endpoint=window.document.location.origin,es&&CIB.config.fileupload&&(CIB.config.fileupload.extraOptionsSet=[],CIB.config.fileupload.extraOptionsSetV2=[])):co?(lo||(CIB.manager.chat.api.bing._endpoint=window.document.location.origin),ti(i)):e?ti(i):t=CIB.insertAt(i),fs&&(po=_ge("id_l"),po&&(po.style.display="inline-block")),SydFSCHelper.setColorScheme(),wo=SydFSCHelper.getConfigOrDefault((pe=_w._sydConvConfig)===null||pe===void 0?void 0:pe.isBingChatForEnterprise,!1),bo=SydFSCHelper.getConfigOrDefault((we=_w._sydConvConfig)===null||we===void 0?void 0:we.enableBCEDynamicPrompts,!1),ps=SydFSCHelper.getConfigOrDefault((be=_w._sydConvConfig)===null||be===void 0?void 0:be.enableThreads,!1),os=wo&&!bo&&typeof BceSydneyHelper!="undefined"?BceSydneyHelper.getSydneyWelcomeCards:undefined,ss=wo&&bo&&typeof BceSydneyHelper!="undefined"?BceSydneyHelper.getFallBackTilesForBCE:undefined,it&&(vr?CIB.theme.addStyles("cib-background",CIB.theme.createStyles(':host([serp-slot="none"][product="bing"][background-type="gradient"]) { background: #'+it+" !important;}")):CIB.theme.addStyles("cib-background",CIB.theme.createStyles(':host([product="bing"][background-type="gradient"]) { background: #'+it+" !important;}"))),ct?si?GPTHomeScreen===null||GPTHomeScreen===void 0?void 0:GPTHomeScreen.attachPersonaChangeEvents(t):sj_evt.fire("cib_init",t):lt?sj_evt.bind("sydWelcomeScreen",function(){SydWelcomeScreen===null||SydWelcomeScreen===void 0?void 0:SydWelcomeScreen.setContent(t,os,ss)},!0):hi&&(SydneyChatFRE===null||SydneyChatFRE===void 0?void 0:SydneyChatFRE.setContent(t)),lo&&MsbSydneyHelper.addTenantLogoToHeader(),hs=SydFSCHelper.getConfigOrDefault((ke=_w._sydConvConfig)===null||ke===void 0?void 0:ke.useAccountLinkingForConversationLimitUpsell,!1),hs&&(CIB.config.bing.signIn.query.action="acclink",CIB.config.bing.signIn.query.crea="MY04B",CIB.config.bing.signIn.query.pn="AccountLinking_Chat",CIB.config.bing.signIn.query.publ="BingIP"),nu(),rs&&CIB.config.sydney.request.optionsSets.push("dlbing"),ao&&CIB.config.sydney.request.optionsSets.push(ao),wi)SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim();else{CIB.config.greeting.shouldSendBotGreeting=SydFSCHelper.shouldForceSendBotGreeting;gt||(sj_evt.bind("ajax.unload",function(){SydFSCHelper.shouldResetBotGreeting=!1}),sj_evt.bind("ajax.load",function(){SydFSCHelper.shouldResetBotGreeting=!0}));CIB.onConversationRequestStateChange(function(n){n||CIB.config.greeting.shouldSendBotGreeting||!SydFSCHelper.shouldResetBotGreeting||(CIB.config.greeting.shouldSendBotGreeting=!0)})}return(gt&&sj_evt.bind("ajax.load",function(){_G[SydFSCHelper.SYD_MODE]="serp"}),cs=SydFSCHelper.getConfigOrDefault((de=_w._sydConvConfig)===null||de===void 0?void 0:de.disResetTT,!1),cs&&(ko=(no=(ge=t===null||t===void 0?void 0:t.shadowRoot)===null||ge===void 0?void 0:ge.querySelector("cib-action-bar"))===null||no===void 0?void 0:no.shadowRoot,ko&&(oo=sj_ce("style"),oo.textContent="\n                    cib-tooltip {\n                        display: none !important;\n                    }\n                ",ko.appendChild(oo))),!(lr&&"SydneyTestHelper"in _w))?[3,4]:[4,SydneyTestHelper===null||SydneyTestHelper===void 0?void 0:SydneyTestHelper.setTestMocks()];case 3:ws.sent();ws.label=4;case 4:bi&&(ls=new URLSearchParams(_w.location.search),go=ls.get("convid"),go&&re(go));eo=(to=_d.querySelector("cib-serp"))===null||to===void 0?void 0:to.shadowRoot;so=eo===null||eo===void 0?void 0:eo.querySelector("cib-conversation");so&&so.shadowRoot&&(v=so.shadowRoot.querySelector(".scroller"),oo=sj_ce("style"),is&&(oo.textContent="\n                cib-notification-container {\n                    display: none;\n                }\n            "),so.shadowRoot.appendChild(oo));us&&(ns=(ro=(io=eo===null||eo===void 0?void 0:eo.querySelector("cib-action-bar"))===null||io===void 0?void 0:io.shadowRoot)===null||ro===void 0?void 0:ro.querySelector(".autosuggest-text"),ns&&(ns.style.display="none"));ts="ontouchstart"in window||!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0;wt&&Log.Log("ClientInst","Codex","TabletScrollDisabled");ts&&Log.Log("ClientInst","Codex","TouchD");bt&&Log.Log("ClientInst","Codex","TouchDesktopScrollDisabled");l||wt||ts&&bt||(sj_be(_w,"mousewheel",pf),sj_be(_w,"touchstart",wf),sj_be(_w,"touchmove",bf),sj_be(_w,"touchend",kf),Log.Log("ClientInst","Codex","BindedScrollEvents"),tr&&(ho=(uo=_d.querySelector("cib-serp"))===null||uo===void 0?void 0:uo.shadowRoot.querySelector("cib-side-panel"),ho&&sj_be(ho,"mouseenter",vf),ho&&sj_be(ho,"mouseleave",yf)));SydFSCHelper.triggerShareFlow();gr();sj_evt.bind("ajax.load",gr);h&&(SydFSCHelper.setupHistory(),SydFSCHelper.checkInitialState());nf();l&&ne();SydFSCHelper.triggerClarity();CIB.onResetConversation(function(){SydFSCHelper.shouldMove1TAnswers(nt,y)&&iu()});CIB.onModeChanged(function(n){sj_evt.fire("onModeChanged",n)});if(CIB.onMobileUpsellPopupShown)CIB.onMobileUpsellPopupShown(function(){var n={convId:CIB.manager.conversation.id,responseTone:CIB.responseTone};SydFSCHelper.SydLog("SystemEvent","MobileUpsell","MobileUpsellPopupShown",n);SydFSCHelper.createRequest("sydchat/writeConvInfo",JSON.stringify(n))});return as=((fo=_w.BingChatCustomGreetingString)===null||fo===void 0?void 0:fo.length)>0,ir&&!as&&SydFSCHelper.processCachedResponseUsingCIB(JSON.parse(rr)),er&&SydFSCHelper.updateChatBackgroundWidth(),or&&SydFSCHelper.hideSignInUpsellFor3P(),yr&&SydFSCHelper.hideTopFade(),[2]}})})}function du(){ct?sj_evt.fire("renderWsSlot",t):lt&&(SydWelcomeScreen===null||SydWelcomeScreen===void 0?void 0:SydWelcomeScreen.addWelcomeContainerChildSlot(t))}function gu(){var n=_ge("b_content");sb_st(function(){n&&Lib.CssClass.contains(n,"b_showconv")&&Lib.CssClass.remove(n,"b_showconv")},0)}function dr(){var i=_ge("b-scopeListItem-web"),t,n;i&&_d&&(t="\n                .b_scopebar #b-scopeListItem-web {\n                    visibility: visible;\n                }\n\n                body:not(.b_notebookMode) #b-scopeListItem-conv::after {\n                    opacity: 0;\n                }\n\n                .b_notebookMode nav.b_scopebar li.b_active#b-scopeListItem-notebook::after {\n                    opacity: 0;\n                }\n            ",n=_d.createElement("style"),n.setAttribute("type","text/css"),_d.head.appendChild(n),n.innerHTML=t);sj_evt.unbind("ajaxReady",dr)}function ti(n){var i=sj_ce("div");t=CIB.insertAt(i);CIB.showConversation();n.appendChild(t)}function gr(){sj_evt.bind("hideSydFSC",function(n){var k,d,it,o,i,r,v,g,u,f,t,e,b;if(!vt){if(vt=!0,Log.Log("ClientInst","Codex","LeaveConversationMode"),c||(Lib.CssClass.remove(sj_b,a),it=_ge("tallhead"),it&&(br?_w.scrollTo(0,0):_w.scrollBy(0,48))),tt&&sb_st(function(){if(!Lib.CssClass.contains(sj_b,a)){var n=_ge("b_header"),t=_d.querySelector(".b_scopebar");t&&(n===null||n===void 0?void 0:n.insertBefore(t,li))}},1e3),o=_ge("sb_form"),o&&Lib.CssClass.contains(o,"hassbi")&&Lib.CssClass.remove(o,"hassbi"),CIB.hideConversation(),c||l||(Lib.CssClass.add(_d.documentElement,"b_delayOvflw"),SydFSCHelper.shouldMove1TAnswers(nt,y)&&iu(),i=_ge("b-scopeListItem-web"),i&&i.children.length>0&&(i.children[0].setAttribute("aria-current","page"),Lib.CssClass.add(i,"b_active"),((k=_G===null||_G===void 0?void 0:_G.EF)===null||k===void 0?void 0:k.chatskip2content)===1||((d=_ge("b_skip_to_content"))===null||d===void 0?void 0:d.setAttribute("tabindex","0"))),r=_ge("b-scopeListItem-conv"),r&&r.children.length>0&&(r.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(r,"b_active")),v=_ge("b_phead_chat"),v&&Lib.CssClass.contains(v,"b_active")&&Lib.CssClass.remove(v,"b_active")),_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],h&&(g=n&&n.length>1?n[1]:!1,g&&SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"BackButton"}),g||SydFSCHelper.pushSydHistory(!1))),!h&&st&&SydFSCHelper.updateConvFlagInURL(!1),SydFSCHelper.updateConvPageTitle(!1),_G[SydFSCHelper.SYD_MODE]="serp",yt){if(u=_ge("b_pole"),!u){for(u=sj_ce("div","b_pole"),f=_d.querySelector("main"),t=_ge("b_results");t&&f&&t.parentElement!=f;)t=t.parentElement;f&&t&&f.insertBefore(u,t)}SydFSCHelper.addCarousel(u)}else if(vi&&(e=CIB.vm.conversation.model.messages.filter(function(n){return n.type==="meta"&&n.text!="Generating answers for you..."||n.type==="text"&&n.author==="user"}),e&&e.length>0)){var p=e[e.length-1].text.split("`"),w=p.length==1?p[0]:p.length==3?p[1]:"",rt=_ge("sb_form_go"),ut=_ge("sb_form_q");_w.sj_isAjax&&w&&ut.value.toLowerCase()!=w.toLowerCase()&&rt&&(ut.value=w,SydFSCHelper.lastQuery=w,rt.click())}s&&sj_evt.fire("switchToWeb");sj_ue(_w,"beforeprint",ru);sj_ue(_w,"afterprint",uu);b=_ge("b_content");b&&Lib.CssClass.contains(b,"b_hide")&&Lib.CssClass.remove(b,"b_hide");eu(!1);vt=!1}});sb_st(function(){ar||(sj_evt.bind("showSydFSC",lf,!0),s&&sj_evt.bind("showNotebook",function(){var n;sj_evt.fire("switchToNotebook");SydFSCHelper.setNotebookOptions();SydFSCHelper.addNotebookFlagInURL();SydFSCHelper.getConfigOrDefault((n=_w._sydConvConfig)===null||n===void 0?void 0:n.enableSetNotebookAlignment,!1)&&t.setAttribute("alignment","left")},!0))},0);sr&&sj_evt.bind("sydFSCLoaded",gu,!0);e&&sj_evt.bind("ajaxReady",dr,!0);sj_evt.bind("onModeChanged",function(n){setTimeout(function(){var t;s&&_G[SydFSCHelper.SYD_PREV_MODE]==="notebook"&&n[1]!=="notebook"&&(SydFSCHelper.setDefaultOptions(),du(),SydFSCHelper.getConfigOrDefault((t=_w._sydConvConfig)===null||t===void 0?void 0:t.enableSetNotebookAlignment,!1)&&nu())},0)});sj_evt.fire("convInit:done")}function nu(){var n,i,r=SydFSCHelper.getConfigOrDefault((n=_w._sydConvConfig)===null||n===void 0?void 0:n.isCopilotChat,!1),u=SydFSCHelper.getConfigOrDefault((i=_w._sydConvConfig)===null||i===void 0?void 0:i.enableThreads,!1);t.setAttribute("alignment",r&&!u?"center":"left")}function tu(){var t;o=((t=_d.getElementsByClassName("b_top"))===null||t===void 0?void 0:t.length)>0?_d.getElementsByClassName("b_top")[0]:null;oi=sj_b.querySelector("#b_sydTigerCont")!=null;ht=!!o&&o.querySelector("#sydwrap_wrapper")!=null;n.moveOnlySydXAnswers&&(u=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat .b_wpt_chat"),u&&(Lib.CssClass.add(u,ci),di=u.querySelector(".b_wpt_creator_content")!=null))}function nf(){var n=_ge("id_hbfo");sj_be(n,"click",function(n){var r=n.target,t,i;_G[SydFSCHelper.SYD_MODE]=="conversation"&&r&&(t=tf(r),t&&t.target!="_blank"&&(i="",t.href.indexOf("/profile/")>=0?i="profile":t.href.indexOf("/account/")>=0&&(i="account"),SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"ClickMenu",target:i})))})}function tf(n){while(n!=null){if(n.tagName=="A"&&Lib.CssClass.contains(n,"hb_section"))return n;n=n.parentElement}return null}function ii(n,t,i){i===void 0&&(i=!1);t&&n&&(i?n.prepend(t):n.appendChild(t))}function rf(n){var u,f,e,o,s,h;if(!ui){ii(_ge("b_sydtoporpole"),n);return}var l=_d.querySelector("cib-serp"),t=(f=(u=_d.querySelector("cib-serp"))===null||u===void 0?void 0:u.shadowRoot)===null||f===void 0?void 0:f.querySelector("cib-conversation"),i=(o=(e=t===null||t===void 0?void 0:t.shadowRoot)===null||e===void 0?void 0:e.querySelector(".scroller"))===null||o===void 0?void 0:o.querySelector(".main cib-welcome-container"),c=(h=(s=t===null||t===void 0?void 0:t.shadowRoot)===null||s===void 0?void 0:s.querySelector(".scroller"))===null||h===void 0?void 0:h.querySelector(".main");t===null||t===void 0?void 0:t.appendChild(b);i?i===null||i===void 0?void 0:i.after(k):c===null||c===void 0?void 0:c.prepend(k);r===null||r===void 0?void 0:r.appendChild(n);ei;ii(l,r);uf()}function uf(){ff();ef()}function ff(){var t=_d.querySelector("#sydFirstAnswer .b_wpt_chat"),n=_d.querySelector("#sydFirstAnswer .b_wpt_chat .b_wpt_chat_inner");t&&n&&(t.querySelector("b_wpt_chat_inner > .b_sideBleed")&&(n.style.padding="0 20px 5px 20px"),t.querySelector(".b_wpt_chat_inner > .wtr_core.b_sideBleed, .b_wpt_chat_inner > .b_sideBleed #lMapContainer, .b_wpt_chat_inner > .ji_container, .b_wpt_chat_inner > .b_sideBleed #placeAnswer, .b_wpt_chat_inner > .b_sideBleed .ckt_main, .b_wpt_chat_inner > .b_sideBleed .mit_ans, .b_wpt_chat_inner > .jobsAnswerContainer, .b_wpt_chat_inner > div .sa_main")&&(n.style.padding="unset"),n.querySelector(".b_wpt_creator")&&(n.style.padding="0px"),n.querySelector(".b_wpt_insights")&&(n.style.paddingTop="0px",n.style.paddingBottom="0px"))}function ef(){var n=_d.querySelector("#sydFirstAnswer .b_wpt_chat");n&&n.querySelector(".b_wpt_creator")&&(n.style.boxShadow="unset")}function sf(){if(tu(),n.moveOnlySydXAnswers){if(!u||gi&&di)return;(y||ht&&!oi)&&sb_st(function(){rf(u)},au)}}function iu(){if(n.moveOnlySydXAnswers){if(!u)return;var t=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat");t&&!t.contains(u)&&u&&(Lib.CssClass.remove(u,ci),ii(t,u,!0))}}function hf(){var n=new URLSearchParams(_w.location.search),t=n.get("sendquery");return t==="1"}function cf(){var n=_ge("conv-css-link");n&&!n.classList.contains("css-conv-added")&&(n.setAttribute("rel","stylesheet"),n.setAttribute("class","css-conv-added"))}function lf(n){var w,b,k,d,g,it,rt,ft,et,ot,ht,ct,dt,lt,t,vt,gt,u,f,v,e,r,kt;if((!SydFSCHelper.getConfigOrDefault((w=_w._sydConvConfig)===null||w===void 0?void 0:w.enableshowSydFSCThrottle,!1)||_G[SydFSCHelper.SYD_MODE]!=="conversation")&&!at){at=!0;SydFSCHelper.updateResponseToneAfterSerp();dt=SydFSCHelper.getConfigOrDefault((b=_w._sydConvConfig)===null||b===void 0?void 0:b.disableAllChatAds,!1);CIB.config.features.enableAds=!dt;ki&&(lt=CIB.config.sydney.request.optionsSets.indexOf("nocacheread"),lt>=0&&CIB.config.sydney.request.optionsSets.splice(lt,1));ur&&cf();_w.scrollY==0&&(br=!0);t=_ge("b_header");vt=!1;t&&ut&&Lib.CssClass.contains(t,ut)&&(Lib.CssClass.remove(t,ut),SydFSCHelper.getConfigOrDefault((k=_w._sydConvConfig)===null||k===void 0?void 0:k.enableShareLinkTrackLog,!1)?(u=new URLSearchParams(window.location.search),gt=!!u.get("shareId")&&!!u.get("shid"),SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:gt?"ShareLink":"ShowConv"})):SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ShowConv"}),s&&(u=new URLSearchParams(window.location.search),vt=u.get("showntbk")==="1"));t&&!Lib.CssClass.contains(t,"b_bcbSwitch")&&hr&&Lib.CssClass.add(t,"b_bcbSwitch");yt&&SydFSCHelper.removeQueries();f=n&&n.length>1?n[1]:null;v=n&&n.length>2?n[2]:null;y=n&&n.length>3?n[3]==lu:!1;var ni=n&&n.length>3?n[3]&&n[3]!=="":!1,ui=n&&n.length>3?(d=n[3])!==null&&d!==void 0?d:"":"",pt=n&&n.length>5?n[5]:null,ei=n&&n.length>6?n[6]:!1,wt=n&&n.length>7?n[7]:!1,oi=n&&n.length>8?n[8]:!1;if(c||l||(_w.scrollY>0&&_w.scrollTo(0,0),_d.documentElement&&(Lib.CssClass.add(_d.documentElement,"b_disOvflw"),Lib.CssClass.remove(_d.documentElement,"b_delayOvflw"))),c||(Lib.CssClass.add(sj_b,a),tt&&sb_st(function(){if(Lib.CssClass.contains(sj_b,a)){var i=_ge("id_h"),n=_d.querySelector(".b_scopebar");li=n&&n.nextSibling;i&&n&&(t===null||t===void 0?void 0:t.insertBefore(n,i))}},1e3)),SydFSCHelper.shouldMove1TAnswers(nt,y,f)&&sf(),f&&(SydFSCHelper.sendFirstQuery(oi?f.trim():f.toLowerCase().trim(),v,pt,wt||hf(),ni),ni&&SydFSCHelper.LogIntEvent("EnteredToChatFromSerpChips",ui,"")),CIB.showConversation(),ei&&(e=[],pt&&e.push({author:"user",text:pt}),v&&e.push({author:"bot",text:v}),fi&&e.length!=0&&CIB.registerContext(e),CIB.toggleSpeechEnabled(),CIB.triggerMic()),!c&&!l){r=_ge("b-scopeListItem-web");r&&r.children.length>0&&r.parentElement&&(r.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(r,"b_active"));var p=_ge("b-scopeListItem-conv"),bt=_ge("b_bceBcbToggle"),ti=bt===null||bt===void 0?void 0:bt.querySelector(".selected");if(p&&p.children.length>0&&(p.children[0].setAttribute("aria-current","page"),Lib.CssClass.add(p,"b_active"),((g=_G===null||_G===void 0?void 0:_G.EF)===null||g===void 0?void 0:g.chatskip2content)===1||((it=_ge("b_skip_to_content"))===null||it===void 0?void 0:it.setAttribute("tabindex","-1")),ti&&wt&&ti.focus(),yi)){var o=_d.querySelector(".b_sydConvMode"),ii=o&&((ct=(ht=(ot=(et=(ft=(rt=o===null||o===void 0?void 0:o.querySelector("cib-serp"))===null||rt===void 0?void 0:rt.shadowRoot)===null||ft===void 0?void 0:ft.querySelector("cib-action-bar"))===null||et===void 0?void 0:et.shadowRoot)===null||ot===void 0?void 0:ot.querySelector(".input-container").querySelector("cib-text-input"))===null||ht===void 0?void 0:ht.shadowRoot)===null||ct===void 0?void 0:ct.querySelector("textarea")),ri=_d.documentElement;o&&ii&&!wt&&ii.focus();ri&&i&&t&&sj_be(ri,"keydown",function(n){Log&&Log.Log("Info","Accessibility","KeyboardNavigationSydney");(n.code=="Tab"||n.keyCode==9||n.key=="Tab")&&(i.contains(n.target||n.srcElement)||t.contains(n.target||n.srcElement)||(i.tabIndex=0,i.focus()))})}}_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],h&&(kt=n&&n.length>4?n[4]:!1,kt&&SydFSCHelper.LogIntEvent("ConversationViewEnter","Conversation",{source:"BackButton"}),kt||SydFSCHelper.pushSydHistory(!0)));!h&&st&&SydFSCHelper.updateConvFlagInURL(!0);SydFSCHelper.updateConvPageTitle(!0);fr||af();_G[SydFSCHelper.SYD_MODE]="conversation";CIB.config.features.enablePartnerVisualSearchUpload&&SydFSCHelper.submitVisualSearchImage();vt&&sj_evt.fire("switchToNotebook");sj_be(_w,"beforeprint",ru);sj_be(_w,"afterprint",uu);eu(!0);at=!1}}function af(){var n=ClientObserver.getBrowserWidth(),t=ClientObserver.getBrowserHeight();SydFSCHelper.set2TQueryConfigs(n,t,nr)}function vf(){dt=!0}function yf(){dt=!1}function pf(n){var t=0;n||(n=window.event);n.wheelDelta?t=n.wheelDelta/60:n.detail&&(t=-n.detail/2);fu(t,ft)}function wf(n){pt=n.changedTouches[0].clientY;w=n.touches&&n.touches.length>1?!0:!1}function bf(n){var t=n.changedTouches[0].clientY-pt;fu(t,cu,!0)}function kf(n){f=0;d=!1;g=!1;pt=0;w=n.touches&&n.touches.length!==0}function ru(){var n=_ge("b_content");n&&Lib.CssClass.add(_ge("b_content"),"b_hide")}function uu(){var n=_ge("b_content");n&&Lib.CssClass.remove(n,"b_hide")}function fu(n,t,i){var r,u,o,h;(i===void 0&&(i=!1),Log.Log("ClientInst","Codex","CheckScrollCalled"),dt)||(sb_ct(ai),d||(p=Lib.CssClass.contains(sj_b,a),g=p?gf():_w.scrollY==0),d=!0,g&&(f+=n),i||(ai=sb_st(function(){f=0;d=!1;g=!1},150)),r=!p&&f>et&&_G[SydFSCHelper.SYD_MODE]!="conversation"&&!w,u=ot&&p&&f<-1*et&&_G[SydFSCHelper.SYD_MODE]=="conversation"&&!w,r=ni&&wr?r&&Lib.CssClass.contains(sj_b,"b_sydStandalone"):r,s&&!u&&(u=ot&&p&&f<-1*et&&_G[SydFSCHelper.SYD_MODE]=="notebook"&&!w),r?(Log.Log("ClientInst","Codex","ScrollToChat"),!kt&&f>t&&(pr?SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ChatBubble"}):SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ScrollUp"}),SydFSCHelper.triggerSydFSCQueryWithContext())):u&&(Log.Log("ClientInst","Codex","ScrollOutChat"),o=s&&_G[SydFSCHelper.SYD_MODE]==="notebook",h=!o||o&&cr,!kt&&h&&f<-1*t&&(e&&!df()?sj_evt.bind("ajaxReady",ri,!0):ri())))}function df(){var n=_ge(vu);return n&&!Lib.CssClass.contains(n,yu)}function ri(){e&&SydFSCHelper.isCookieBannerVisibileOnChatPage()||(SydFSCHelper.LogIntEvent("ConversationViewExit","Scope",{source:"ScrollDown",target:_G[SydFSCHelper.SYD_PREV_MODE]}),sj_evt.fire("hideSydFSC"),sb_st(function(){_w.scrollTo(0,0)},1),(e||ni)&&sj_evt.unbind("ajaxReady",ri))}function gf(){return!v?!1:Math.abs(v.scrollTop-(v.scrollHeight-v.offsetHeight))<1}function ne(){var t,i,r,e=_ge("b_sydOvrClose"),n,u,f;e&&sj_be(e,"click",function(){sj_evt.fire("hideSydFSC")});n=(r=(i=(t=_d.querySelector("#b_sydConvCont cib-serp"))===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("cib-action-bar"))===null||r===void 0?void 0:r.shadowRoot;u=n===null||n===void 0?void 0:n.querySelector(".outside-left-container");u&&(u.style.display="none");pi&&n&&(f=sj_ce("style"),f.textContent="\n                .control.microphone {\n                    display: none;\n                }\n            ",n.appendChild(f))}function te(n){var i,r,t=_ge("id_rfob");n&&((i=t===null||t===void 0?void 0:t.style)===null||i===void 0?void 0:i.display)?t.style.display="none":undefined;!n&&((r=t===null||t===void 0?void 0:t.style)===null||r===void 0?void 0:r.display)?t.style.display="inline-flex":undefined}function eu(n){var t,i,r=SydFSCHelper.getConfigOrDefault((t=_w._sydConvConfig)===null||t===void 0?void 0:t.isCompliantSydneyEndpointEnabled,!1),u=SydFSCHelper.getConfigOrDefault((i=_w._sydConvConfig)===null||i===void 0?void 0:i.isBingChatForEnterprise,!1);(r||u)&&te(n)}function ie(n,t){var i,r;n===void 0&&(n=null);t===void 0&&(t=ft);r=(i=_w._sydPayWallConfig)===null||i===void 0?void 0:i.loadSydneyConvResWithPayWall;r?sj_evt.bind("waitlistUpdate:eligible",kr,!0):void kr(n);ft=t}function re(n){CIB.loadConversation(n);SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim()}var rt,a="b_sydConvMode",ut="b_sydShowConv",su="b_sydConvCont",hu="b_ctf",ft=10,et=10,cu=100,ui,ot,fi,h,st,ei=!1,o,ht,u=null,oi=!1,t,ct,si,lt,hi,v,r,b,k,lu="SYDX_WRAPPER",y=!1,ci="b_sydxwrappedanswer",au=1e3,at=!1,vt=!1,li=null,vu="b_content",yu="noSecondChunk",f=0,ai,d=!1,g=!1,p=!1,pu=!1,nt=!1,vi=!1,yt=!1,c=!1,l=!1,yi=!1,pt,ou;n.moveOnlySydXAnswers=!1;var pi=!1,wi=!1,bi=!1,wu=!1,ki=!1,di=!1,gi=!1,nr=!1,wt=!1,bt=!1,kt=!1,tr=!1,dt=!1,gt=!1,ir=!1,rr="",w=!1,ur,fr=!1,er=!1,or=!1,sr=!1,hr=!1,s=!1,cr=!1,lr=!1,tt=!1,ar=!1,it="",vr=!1,yr=!1,pr=!1,bu=!1,e=!1,ni=!1,wr=!1,ku=!1,br=!1,i;(typeof sj_b=="undefined"||sj_b==null)&&(window.sj_b=document.body);n.init1TAnswerContents=tu;n.initWithWaitlistUpdate=ie;ou=SydFSCHelper.getConfigOrDefault((rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSuperBowlWelcomescreenTest,!1);ou&&typeof WelcomeScreenLoader!="undefined"&&WelcomeScreenLoader.loadWelcomeScreen();sj_evt.fire("sydFSC.init")})(SydneyFullScreenConv||(SydneyFullScreenConv={}))